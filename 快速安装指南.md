# âš¡ 5åˆ†é’Ÿå¿«é€Ÿå®‰è£…æŒ‡å—

**ç›®æ ‡**: åœ¨ `172.25.76.174` æœåŠ¡å™¨ä¸Šéƒ¨ç½²è´¹ç”¨åˆ†æ‘Šç®¡ç†ç³»ç»Ÿ

## ğŸ“‹ å‰ç½®æ¡ä»¶æ£€æŸ¥

```bash
# æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬ (éœ€è¦Ubuntu 20.04+ æˆ– Debian 11+)
lsb_release -a

# æ£€æŸ¥å†…å­˜ (è‡³å°‘4GB)
free -h

# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
sudo netstat -tlnp | grep -E ":80|:443|:8000|:8080|:5432|:6379|:5050"
```

## ğŸš€ 3æ­¥å¿«é€Ÿéƒ¨ç½²

### æ­¥éª¤1: è§£å‹é¡¹ç›®æ–‡ä»¶
```bash
# åˆ›å»ºå·¥ä½œç›®å½•
cd /home/sadm
sudo tar -xzf projectpg12-complete-final.tar.gz

# è¿›å…¥é¡¹ç›®ç›®å½•
cd projectpg12

# ç»™éƒ¨ç½²è„šæœ¬æ‰§è¡Œæƒé™
chmod +x auto-deploy.sh
```

### æ­¥éª¤2: è¿è¡Œè‡ªåŠ¨éƒ¨ç½²è„šæœ¬
```bash
# æ‰§è¡Œè‡ªåŠ¨éƒ¨ç½²
./auto-deploy.sh

# âš ï¸ é‡è¦: å¦‚æœæç¤ºéœ€è¦é‡æ–°ç™»å½•Dockerç»„ï¼Œè¯·å…ˆç™»å½•ï¼š
newgrp docker
# ç„¶åé‡æ–°è¿è¡Œéƒ¨ç½²è„šæœ¬
```

### æ­¥éª¤3: éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡æ˜¯å¦è¿è¡Œæ­£å¸¸
docker ps

# æ£€æŸ¥SSLè¯ä¹¦çŠ¶æ€
sudo certbot certificates

# æµ‹è¯•è®¿é—®
curl -I https://172.25.76.174:443/
```

## âœ… éƒ¨ç½²æˆåŠŸéªŒè¯

### è®¿é—®æµ‹è¯•
- **ä¸»åº”ç”¨**: https://172.25.76.174:443/
- **APIæ–‡æ¡£**: https://172.25.76.174:443/docs  
- **pgAdmin**: http://172.25.76.174:5050
  - ç”¨æˆ·å: `admin@expense.local`
  - å¯†ç : `admin123`

### åŠŸèƒ½æµ‹è¯•æ¸…å•
- [ ] é¡µé¢å¯ä»¥æ­£å¸¸åŠ è½½
- [ ] ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½æ­£å¸¸
- [ ] ç”¨æˆ·ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] å¯ä»¥åˆ›å»ºç¾¤ç»„
- [ ] å¯ä»¥æ·»åŠ è´¹ç”¨è®°å½•
- [ ] è´¹ç”¨åˆ†æ‘Šè®¡ç®—æ­£ç¡®

## ğŸ”§ å¸¸ç”¨ç»´æŠ¤å‘½ä»¤

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/sadm/projectpg12

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# æ›´æ–°ä»£ç å¹¶é‡æ–°éƒ¨ç½²
git pull  # å¦‚æœä½¿ç”¨Git
docker-compose up -d --build
```

## ğŸ†˜ æ•…éšœæ’é™¤

### é—®é¢˜1: ç«¯å£è¢«å ç”¨
```bash
# æ‰¾åˆ°å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo lsof -i :80
sudo lsof -i :443

# åœæ­¢å†²çªè¿›ç¨‹
sudo systemctl stop apache2
sudo systemctl disable apache2
```

### é—®é¢˜2: SSLè¯ä¹¦ç”Ÿæˆå¤±è´¥
```bash
# æ‰‹åŠ¨ç”Ÿæˆè¯ä¹¦
sudo certbot certonly --standalone -d 172.25.76.174

# æ£€æŸ¥è¯ä¹¦çŠ¶æ€
sudo certbot certificates
```

### é—®é¢˜3: Dockeræƒé™é—®é¢˜
```bash
# é‡æ–°é…ç½®Dockerç»„
sudo usermod -aG docker $USER
# ç„¶åé‡æ–°ç™»å½•
newgrp docker
```

### é—®é¢˜4: æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
docker-compose logs backend
docker-compose logs nginx

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat docker-compose.yml
```

## ğŸ”„ æ›´æ–°å’Œå¤‡ä»½

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
docker-compose exec postgres pg_dump -U expense_user expense_dev > backup_$(date +%Y%m%d).sql

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf uploads_backup_$(date +%Y%m%d).tar.gz data/postgres/
```

### åº”ç”¨æ›´æ–°
```bash
# å¤‡ä»½æ•°æ®
./auto-deploy.sh backup

# æ›´æ–°ä»£ç 
git pull

# é‡æ–°æ„å»º
docker-compose up -d --build
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

```bash
# å®æ—¶ç›‘æ§èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/backend/app.log
tail -f logs/nginx/error.log

# ç³»ç»Ÿèµ„æºç›‘æ§
htop
df -h
```

## ğŸ”’ å®‰å…¨é…ç½®

### é˜²ç«å¢™è®¾ç½®
```bash
# å¯ç”¨é˜²ç«å¢™
sudo ufw enable

# å¼€æ”¾å¿…è¦ç«¯å£
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS

# ç¦æ­¢ç›´æ¥è®¿é—®å†…éƒ¨ç«¯å£
sudo ufw deny 8000   # API
sudo ufw deny 8080   # Frontend
sudo ufw deny 5432   # PostgreSQL
sudo ufw deny 6379   # Redis
sudo ufw deny 5050   # pgAdmin
```

### SSLè¯ä¹¦è‡ªåŠ¨ç»­æœŸ
```bash
# è®¾ç½®è‡ªåŠ¨ç»­æœŸcronä»»åŠ¡
echo "0 12 * * * /usr/bin/certbot renew --quiet" | sudo crontab -

# æ‰‹åŠ¨ç»­æœŸ
sudo certbot renew
```

---

**ğŸ¯ éƒ¨ç½²å®Œæˆåï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªå®Œå…¨åŠŸèƒ½çš„è´¹ç”¨åˆ†æ‘Šç®¡ç†ç³»ç»Ÿï¼**

**ğŸ“ å¦‚éœ€å¸®åŠ©ï¼Œè¯·æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£**: `deployment-guide-for-172.25.76.174.md`